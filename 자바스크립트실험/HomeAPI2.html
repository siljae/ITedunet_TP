<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
    <title>간단한 지도 표시하기</title>
    <script type="text/javascript" src="https://openapi.map.naver.com/openapi/v3/maps.js?ncpClientId=y4eqwdh098&submodules=geocoder"></script>
    <style>
        .container{
            display: flex;
        }
        #list{
            width: 200px;
        }
    </style>
</head>
<body>
    <div class="container" style="width:60%;margin: 0 auto;">
        <div id="list"></div>
        <div id="map" style="width: 80%;height:600px;"></div>
    </div>
    <script>
        let map;
        let lat, lng;        

        //현재 접속한 브라우저의 위도, 경도 받아오기
        if(navigator.geolocation){
            navigator.geolocation.getCurrentPosition(function(position){
                //현재 접속한 브라우저의 위도
                lat = position.coords.latitude;
                //현재 접속한 브라우저의 경도
                lng = position.coords.longitude;

                createMap(lat, lng);
            })
        }
        else{
            alert("현재 접속하신 브라우저에서는 사용하실 수 없는 기능입니다.\n크롬으로 접속해주세요");
        }

        //지도 생성
        function createMap(lat, lng){
            let mapContainer = document.getElementById('map'),
            mapOption = {
                center : new naver.maps.LatLng(lat, lng),
                zoom : 16,
                zoomControl : true, //줌 컨트롤 표시 여부
                zoomControlOptions : {  //줌 컨트롤의 옵션
                    position : naver.maps.Position.TOP_RIGHT
                }            
            };
            map = new naver.maps.Map(mapContainer, mapOption); 

            hospitalSearch(lat, lng);
        }

        let callback = function(result, status){            
            if(status == naver.maps.Service.Status.OK){
                let listbox = document.getElementById('list')
                for(let i=0; i<result.length; i++){
                    createMarker(result[i]);
                    let hosdata = result[i];
                    let hosNode = document.createElement('div');
                    hosNode.innerHTML = 
                    `<p><b>`+hosdata.place_name+`</b></p>
                    <p>`+hosdata.road_address_name+`</p>
                    <p>`+hosdata.phone+`</p>`;
                    listbox.appendChild(hosNode);
                }
            }
        };

        //동물병원 검색하기
        function hospitalSearch(lat, lng){
            naver.maps.Service.keywordSearch('동물병원', callback, {
                location : new naver.maps.LatLng(lat, lng),
                radius : 1000,
                page : 5
            });
        }
    </script>
</body>
</html>